import{c as re,a as y,d as K,f as C,e as Y,s as R}from"../chunks/DLEunuUT.js";import{f as O,p as z,u as J,e as x,s,t as B,g as u,b as F,d as j,c as n,r as a,am as se,n as W,B as ie}from"../chunks/DGbS--Tb.js";import{i as H}from"../chunks/n2OIzAHn.js";import{e as Q,i as V}from"../chunks/B_GUWsKK.js";import{g as ce}from"../chunks/aPq9-u7L.js";import{c as Z}from"../chunks/Deku_TYj.js";import{s as M,r as q,i as ue,d as de,b as ve,e as fe,f as be}from"../chunks/C_moINmN.js";import{b as X,a as pe}from"../chunks/Bd0YDvlH.js";import{b as me}from"../chunks/bmokF4QT.js";import{l as _e,s as xe,p as U}from"../chunks/DifGwDUE.js";import{c as D}from"../chunks/DuQ0O-W-.js";import"../chunks/BtEssRjv.js";import{s as ge,a as he}from"../chunks/91cOknPb.js";import{b as ye,e as we}from"../chunks/DS7p5xUN.js";import{S as ne}from"../chunks/cj_QiOwn.js";import{f as ee}from"../chunks/DQUEeQ73.js";import{u as te,c as ke}from"../chunks/CrsfmuFP.js";import{P as Ce}from"../chunks/LaCJMPtk.js";import"../chunks/W9-4QCck.js";import{I as Te,s as Se}from"../chunks/DwLzMF7g.js";function Ee(k,o){const e=_e(o,["children","$$slots","$$events","$$legacy"]);const t=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];Te(k,xe({name:"arrow-right"},()=>e,{get iconNode(){return t},children:(i,c)=>{var v=re(),d=O(v);Se(d,o,"default",{}),y(i,v)},$$slots:{default:!0}}))}var $e=C("<div><!></div>"),Ae=C('<button class="w-full flex items-center px-4 py-3 hover:bg-neutral-800 transition-colors text-left"><div><!></div> <span class="text-white"> </span></button>'),Re=C('<div class="absolute z-10 w-full mt-2 bg-neutral-900 border border-neutral-700 rounded-lg shadow-lg max-h-64 overflow-y-auto"></div>'),Be=C('<div class="relative"><div><!> <input placeholder="Select category..."/></div> <!> <div class="mb-6"></div></div>');function Ie(k,o){z(o,!0);let e=U(o,"value",15,""),t=j(""),i=j(!1),c=j(!1),v;J(()=>{e()&&D[e()]&&(x(t,e(),!0),x(c,!1))});let d=se(()=>Object.keys(D).filter(b=>b.toLowerCase().includes(u(t).toLowerCase())));function p(){x(i,!0),e(""),x(c,!1)}function w(b){e(b),x(t,b,!0),x(i,!1),x(c,!1)}function T(){x(i,!0)}function g(){setTimeout(()=>{x(i,!1),u(t)&&!D[u(t)]&&x(c,!0)},200)}var f=Be(),r=n(f);M(r,1,"flex items-center bg-neutral-900 rounded-lg ");var m=n(r);{var _=b=>{var A=$e(),l=n(A);Z(l,()=>D[e()].icon,(I,S)=>{S(I,{size:24,class:"text-white"})}),a(A),B(()=>M(A,1,`w-12 h-12 ${D[e()].color} rounded-full mr-4 flex items-center justify-center shrink-0`)),y(b,A)};H(m,b=>{e()&&D[e()]&&b(_)})}var h=s(m,2);q(h),h.__input=p,me(h,b=>v=b,()=>v),a(r);var E=s(r,2);{var $=b=>{var A=Re();Q(A,21,()=>u(d),V,(l,I)=>{var S=Ae();S.__click=()=>w(u(I));var P=n(S),N=n(P);Z(N,()=>D[u(I)].icon,(oe,le)=>{le(oe,{size:18,class:"text-white"})}),a(P);var L=s(P,2),G=n(L,!0);a(L),a(S),B(()=>{M(P,1,`w-8 h-8 ${D[u(I)].color} rounded-full mr-3 flex items-center justify-center`),R(G,u(I))}),y(l,S)}),a(A),y(b,A)};H(E,b=>{u(i)&&u(d).length>0&&b($)})}W(2),a(f),B(()=>M(h,1,`flex-1 bg-transparent outline-none text-white ${u(c)?"border border-red-500":"border-none"} focus-within:border-blue-500 text-2xl font-bold px-0`)),Y("focus",h,T),Y("blur",h,g),X(h,()=>u(t),b=>x(t,b)),y(k,f),F()}K(["input","click"]);var Pe=C("<option> </option>"),Ue=C('<div class="flex flex-col gap-2"><label for="account-select" class="text-sm text-neutral-400">Account</label> <select id="account-select" class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none"><option>Select an account</option><!></select></div>');function je(k,o){z(o,!0);const e=()=>ge(v,"$accounts",t),[t,i]=he();let c=U(o,"account",15);const v=ye;var d=Ue(),p=s(n(d),2);p.__change=r=>{const _=r.currentTarget.value;if(_&&e()){const h=e().find(E=>E.id===_);h&&c({name:h.name,currency:h.currency})}else c(null)};var w=n(p);w.value=w.__value="";var T=s(w);{var g=r=>{var m=re(),_=O(m);Q(_,1,e,V,(h,E)=>{var $=Pe(),b=n($);a($);var A={};B(()=>{R(b,`${u(E).name??""} (${u(E).currency??""})`),A!==(A=u(E).id)&&($.value=($.__value=u(E).id)??"")}),y(h,$)}),y(r,m)};H(T,r=>{e()&&r(g)})}a(p);var f;ue(p),a(d),B(r=>{f!==(f=r)&&(p.value=(p.__value=r)??"",de(p,r))},[()=>c()&&e()?e().find(r=>c()!=null&&r.name===c().name&&r.currency===c().currency)?.id:""]),y(k,d),F(),i()}K(["change"]);var De=C('<div class="flex flex-col gap-2"><label class="text-sm text-neutral-400">Balance</label> <div class="flex gap-2"><input type="number" step="0.01" placeholder="0.00" class="flex-1 bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none disabled:opacity-50 disabled:cursor-not-allowed"/> <select class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none disabled:opacity-50 disabled:cursor-not-allowed"><option>EUR</option><option>USD</option><option>RUB</option><option>ARS</option></select></div></div>');function ae(k,o){z(o,!0);let e=U(o,"balance",15),t=U(o,"disabled",3,!1),i=U(o,"disabledCurrency",3,!1);e()||e({value:0,currency:"EUR"});var c=De(),v=s(n(c),2),d=n(v);q(d);var p=s(d,2),w=n(p);w.value=w.__value="EUR";var T=s(w);T.value=T.__value="USD";var g=s(T);g.value=g.__value="RUB";var f=s(g);f.value=f.__value="ARS",a(p),a(v),a(c),B(()=>{d.disabled=t(),p.disabled=i()||t()}),X(d,()=>e().value,r=>e(e().value=r,!0)),ve(p,()=>e().currency,r=>e(e().currency=r,!0)),y(k,c),F()}var ze=C('<label class="text-sm text-neutral-400"> </label>'),Fe=C('<div class="flex flex-col gap-2"><!> <input type="text" class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none disabled:opacity-50 disabled:cursor-not-allowed"/></div>');function Ne(k,o){z(o,!0);let e=U(o,"value",15),t=U(o,"label",3,""),i=U(o,"placeholder",3,""),c=U(o,"disabled",3,!1);var v=Fe(),d=n(v);{var p=T=>{var g=ze(),f=n(g,!0);a(g),B(()=>R(f,t())),y(T,g)};H(d,T=>{t()&&T(p)})}var w=s(d,2);q(w),a(v),B(()=>{fe(w,"placeholder",i()),w.disabled=c()}),X(w,e),y(k,v),F()}function Oe(k){return k.name+" "+k.currency}var Le=C(" <button> </button>",1),Me=C('<div class="flex flex-col gap-2"><label class="text-sm text-neutral-400"> </label> <div class="flex gap-2"></div></div>');function He(k,o){z(o,!0);let e=U(o,"option",15);var t=Me(),i=n(t),c=n(i,!0);a(i);var v=s(i,2);Q(v,21,()=>o.options,V,(d,p)=>{W();var w=Le(),T=O(w),g=s(T);g.__click=()=>e(u(p).value);var f=n(g,!0);a(g),B(r=>{R(T,`${r??""} `),M(g,1,`flex-1 bg-neutral-800 text-white px-3 py-2 rounded border outline-none ${e()===u(p).value?"border-amber-600":"border-neutral-700"}`),R(f,u(p).label)},[()=>console.log(u(p),e())]),y(d,w)}),a(v),a(t),B(()=>R(c,o.name)),y(k,t),F()}K(["click"]);var Ke=C('<div class="flex items-center gap-2"><input type="checkbox" class="w-4 h-4 rounded border-neutral-700 bg-neutral-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0"/> <span class="text-sm text-neutral-400"> </span></div>');function Qe(k,o){z(o,!0);let e=U(o,"checked",15);var t=Ke(),i=n(t);q(i);var c=s(i,2),v=n(c,!0);a(c),a(t),B(()=>R(v,o.name)),pe(i,e),y(k,t),F()}var Ve=C('<h2>Transfer</h2> <p class="text-neutral-500"> </p>',1),qe=C("<div><h2>Transfer</h2> <h2> </h2> <h2> </h2> <h2> </h2></div> <p> </p> <p> </p>",1),Ge=C('<div class="p-4 flex flex-col gap-4"><!> <!> <!> <!> <!> <!></div>'),Je=C('<button type="button" class="w-full space-y-1 bg-neutral-800 rounded-2xl p-4 hover:bg-neutral-700 transition-colors text-left"><!></button> <!>',1);function We(k,o){z(o,!0);let e=U(o,"transfer",15);U(o,"edit",3,!1);let t=j(!1),i=j("Empty transfer");const c=[{label:"Credit",value:"credit"},{label:"Debit",value:"debit"}];J(()=>{const f=e().account,r=e().amount_local?.value,m=e().amount_local?.currency;(async()=>{let _=[];await we(f)||_.push("account"),r||_.push("amount"),m||_.push("currency"),_.length>0?x(i,"Empty transfer - missing "+_.join(", ")):x(i,"")})()}),J(()=>{e()==null&&e({account:{name:"",currency:""},balance:{value:0,currency:""},description:"",amount_local:{value:0,currency:""},kind:"debit",internal:!1}),e().balance==null&&e(e().balance={value:0,currency:""},!0),e(e().balance.currency=e().account?.currency||"",!0),e().amount_local==null&&e(e().amount_local={value:0,currency:""},!0),e().amount_local?.value===0&&e(e().amount_local.currency=e().account?.currency||"",!0)});var v=Je(),d=O(v);d.__click=()=>x(t,!0);var p=n(d);{var w=f=>{var r=Ve(),m=s(O(r),2),_=n(m,!0);a(m),B(()=>R(_,u(i))),y(f,r)},T=f=>{var r=qe(),m=O(r),_=s(n(m),2),h=n(_,!0);a(_);var E=s(_,2),$=n(E,!0);a(E);var b=s(E,2),A=n(b,!0);a(b),a(m);var l=s(m,2),I=n(l,!0);a(l);var S=s(l,2),P=n(S);a(S),B((N,L,G)=>{M(_,1,be(e()?.description===""?"text-neutral-600":"")),R(h,e().description||"No description"),R($,e().description),R(A,N),R(I,L),R(P,`${G??""} ${e().amount_local.currency??""}`)},[()=>Oe(e().account),()=>ee(e().balance),()=>ee(e().amount_local)]),y(f,r)};H(p,f=>{u(i).length>0?f(w):f(T,!1)})}a(d);var g=s(d,2);ne(g,{get show(){return u(t)},title:"Edit Transfer",onClose:()=>x(t,!1),showBackButton:!0,fullHeight:!0,children:(f,r)=>{var m=Ge(),_=n(m);je(_,{get account(){return e().account},set account(l){e(e().account=l,!0)}});var h=s(_,2);ae(h,{disabledCurrency:!0,get balance(){return e().balance},set balance(l){e(e().balance=l,!0)}});var E=s(h,2);Ne(E,{label:"Description",placeholder:"Enter description",get value(){return e().description},set value(l){e(e().description=l,!0)}});var $=s(E,2);ae($,{get balance(){return e().amount_local},set balance(l){e(e().amount_local=l,!0)}});var b=s($,2);He(b,{name:"Kind",get options(){return c},get option(){return e().kind},set option(l){e(e().kind=l,!0)}});var A=s(b,2);Qe(A,{name:"Internal Transfer",get checked(){return e().internal},set checked(l){e(e().internal=l,!0)}}),a(m),y(f,m)},$$slots:{default:!0}}),y(k,v),F()}K(["click"]);var Xe=C('<div class="bg-neutral-900 rounded-lg p-1"><!></div>'),Ye=C('<div class="bg-red-500/10 border border-red-500 text-red-500 px-4 py-3 rounded-lg mt-6"> </div>'),Ze=C('<div class="flex flex-col py-2"><button type="button" class="w-full px-4 py-4 flex items-center justify-between hover:bg-neutral-800 transition-colors"><span class="text-white font-medium">Transfer</span> <!></button></div>'),et=C('<div class="mx-4 mt-4"><h1 class="text-2xl font-bold mb-6">Create Transaction</h1> <!> <div class="space-y-6"></div> <button type="button" class="w-full bg-neutral-800 hover:bg-neutral-700 text-white font-medium text-lg py-4 px-6 rounded-lg mt-6 transition-colors flex items-center justify-center gap-2"><!> Add</button> <!> <button class="w-full bg-blue-500 hover:bg-blue-600 disabled:bg-neutral-700 disabled:cursor-not-allowed text-white font-bold text-lg py-4 px-6 rounded-lg mt-6 transition-colors"> </button></div> <!>',1);function yt(k,o){z(o,!0);function e(){return{id:te(),category:"",date:new Date().toISOString(),movements:[]}}let t=ie(e()),i=j(""),c=j(!1),v=j(""),d=j(!1);function p(){t.movements=[...t.movements,{account:null,account_balance:null,values:[]}],x(d,!1)}async function w(){x(c,!0),x(v,"");try{t.category=u(i),t.id=te(),await ke(t),ce("/transactions")}catch(l){x(v,l instanceof Error?l.message:"Failed to create transaction",!0),console.error("Failed to create transaction:",l)}finally{x(c,!1)}}var T=et(),g=O(T),f=s(n(g),2);Ie(f,{get value(){return u(i)},set value(l){x(i,l,!0)}});var r=s(f,2);Q(r,21,()=>t.movements,V,(l,I,S)=>{var P=Xe(),N=n(P);We(N,{edit:!0,get transfer(){return t.movements[S]},set transfer(L){t.movements[S]=L}}),a(P),y(l,P)}),a(r);var m=s(r,2);m.__click=()=>x(d,!0);var _=n(m);Ce(_,{class:"w-5 h-5"}),W(),a(m);var h=s(m,2);{var E=l=>{var I=Ye(),S=n(I,!0);a(I),B(()=>R(S,u(v))),y(l,I)};H(h,l=>{u(v)&&l(E)})}var $=s(h,2);$.__click=w;var b=n($,!0);a($),a(g);var A=s(g,2);ne(A,{get show(){return u(d)},title:"Add to Transaction",onClose:()=>x(d,!1),children:(l,I)=>{var S=Ze(),P=n(S);P.__click=p;var N=s(n(P),2);Ee(N,{class:"w-5 h-5 text-neutral-500"}),a(P),a(S),y(l,S)},$$slots:{default:!0}}),B(()=>{$.disabled=u(c)||!u(i),R(b,u(c)?"Creating...":"Create Transaction")}),y(k,T),F()}K(["click"]);export{yt as component};
