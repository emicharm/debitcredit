import{R as l,af as v,al as u,ag as m,$ as b,a7 as p,k as g,a2 as k,as as y,a8 as w,at as _,a9 as M,au as x,av as D,g as S,aw as A,e as B,ax as F}from"./DGbS--Tb.js";class U{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#i=!0;constructor(s,t=!0){this.anchor=s,this.#i=t}#r=()=>{var s=l;if(this.#s.has(s)){var t=this.#s.get(s),e=this.#t.get(t);if(e)v(e),this.#a.delete(t);else{var r=this.#e.get(t);r&&(this.#t.set(t,r.effect),this.#e.delete(t),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),e=r.effect)}for(const[a,n]of this.#s){if(this.#s.delete(a),a===s)break;const f=this.#e.get(n);f&&(u(f.effect),this.#e.delete(n))}for(const[a,n]of this.#t){if(a===t||this.#a.has(a))continue;const f=()=>{if(Array.from(this.#s.values()).includes(a)){var h=document.createDocumentFragment();y(n,h),h.append(b()),this.#e.set(a,{effect:n,fragment:h})}else u(n);this.#a.delete(a),this.#t.delete(a)};this.#i||!e?(this.#a.add(a),m(n,f,!1)):f()}}};#n=s=>{this.#s.delete(s);const t=Array.from(this.#s.values());for(const[e,r]of this.#e)t.includes(e)||(u(r.effect),this.#e.delete(e))};ensure(s,t){var e=l,r=w();if(t&&!this.#t.has(s)&&!this.#e.has(s))if(r){var a=document.createDocumentFragment(),n=b();a.append(n),this.#e.set(s,{effect:p(()=>t(n)),fragment:a})}else this.#t.set(s,p(()=>t(this.anchor)));if(this.#s.set(e,s),r){for(const[f,c]of this.#t)f===s?e.skipped_effects.delete(c):e.skipped_effects.add(c);for(const[f,c]of this.#e)f===s?e.skipped_effects.delete(c.effect):e.skipped_effects.add(c.effect);e.oncommit(this.#r),e.ondiscard(this.#n)}else g&&(this.anchor=k),this.#r()}}let o=!1,d=Symbol();function $(i,s,t){const e=t[s]??={store:null,source:M(void 0),unsubscribe:_};if(e.store!==i&&!(d in t))if(e.unsubscribe(),e.store=i??null,i==null)e.source.v=void 0,e.unsubscribe=_;else{var r=!0;e.unsubscribe=x(i,a=>{r?e.source.v=a:B(e.source,a)}),r=!1}return i&&d in t?D(i):S(e.source)}function C(){const i={};function s(){A(()=>{for(var t in i)i[t].unsubscribe();F(i,d,{enumerable:!1,value:!0})})}return[i,s]}function E(i){var s=o;try{return o=!1,[i(),o]}finally{o=s}}export{U as B,C as a,E as c,$ as s};
