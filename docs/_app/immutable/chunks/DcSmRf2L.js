import{c as Ne,a as V,f as z}from"./BAiWUMxs.js";import{aN as De,aI as Ie,b as Se,r as ke,G as Ae,z as B,aR as Re,a3 as Me,aH as x,d as t,s as n,a4 as ge,f as me,u as Ce,a7 as u,a5 as W,a6 as _e,a9 as l,a8 as c,aJ as Ve}from"./C2Gd-opD.js";import{d as he,e as re,s as xe}from"./BTXFnc8K.js";import{I as Ge,s as $e,r as ne,a as fe,b as Ue}from"./xBARtqOG.js";import{s as L,e as Pe,i as qe,l as Be,d as ve}from"./DysnsIBk.js";import{i as be,s as Fe,a as Le}from"./BllsiFYd.js";import{b as ze}from"./DuMZG1ON.js";import{l as Oe,s as We,p as C}from"./C8lAee4v.js";import"./DsfFs0Vy.js";function oe(e,a,r=a){var s=new WeakSet;De(e,"input",async p=>{var f=p?e.defaultValue:e.value;if(f=ee(e)?te(f):f,r(f),B!==null&&s.add(B),await Ie(),f!==(f=a())){var y=e.selectionStart,_=e.selectionEnd,d=e.value.length;if(e.value=f??"",_!==null){var v=e.value.length;y===_&&_===d&&v>d?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=y,e.selectionEnd=Math.min(_,v))}}}),(Ae&&e.defaultValue!==e.value||Se(a)==null&&e.value)&&(r(ee(e)?te(e.value):e.value),B!==null&&s.add(B)),ke(()=>{var p=a();if(e===document.activeElement){var f=Re??B;if(s.has(f))return}ee(e)&&p===te(e.value)||e.type==="date"&&!p&&!e.value||p!==e.value&&(e.value=p??"")})}function ee(e){var a=e.type;return a==="number"||a==="range"}function te(e){return e===""?null:+e}function Xe(e,a){const r=Oe(a,["children","$$slots","$$events","$$legacy"]);const s=[["path",{d:"m6 9 6 6 6-6"}]];Ge(e,We({name:"chevron-down"},()=>r,{get iconNode(){return s},children:(p,f)=>{var y=Ne(),_=Me(y);$e(_,a,"default",{}),V(p,y)},$$slots:{default:!0}}))}class He{#e=x("transactions");get currentView(){return t(this.#e)}set currentView(a){n(this.#e,a,!0)}navigateTo(a){this.currentView=a}}const Je=new He,ye="0123456789ABCDEFGHJKMNPQRSTVWXYZ",X=32,Ke=16,Ee=10,pe=0xffffffffffff;var k;(function(e){e.Base32IncorrectEncoding="B32_ENC_INVALID",e.DecodeTimeInvalidCharacter="DEC_TIME_CHAR",e.DecodeTimeValueMalformed="DEC_TIME_MALFORMED",e.EncodeTimeNegative="ENC_TIME_NEG",e.EncodeTimeSizeExceeded="ENC_TIME_SIZE_EXCEED",e.EncodeTimeValueMalformed="ENC_TIME_MALFORMED",e.PRNGDetectFailure="PRNG_DETECT",e.ULIDInvalid="ULID_INVALID",e.Unexpected="UNEXPECTED",e.UUIDInvalid="UUID_INVALID"})(k||(k={}));class F extends Error{constructor(a,r){super(`${r} (${a})`),this.name="ULIDError",this.code=a}}function Qe(e){const a=Math.floor(e()*X)%X;return ye.charAt(a)}function Ze(e){const a=Ye(),r=a&&(a.crypto||a.msCrypto)||null;if(typeof r?.getRandomValues=="function")return()=>{const s=new Uint8Array(1);return r.getRandomValues(s),s[0]/256};if(typeof r?.randomBytes=="function")return()=>r.randomBytes(1).readUInt8()/256;throw new F(k.PRNGDetectFailure,"Failed to find a reliable PRNG")}function Ye(){return tt()?self:typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:null}function je(e,a){let r="";for(;e>0;e--)r=Qe(a)+r;return r}function et(e,a=Ee){if(isNaN(e))throw new F(k.EncodeTimeValueMalformed,`Time must be a number: ${e}`);if(e>pe)throw new F(k.EncodeTimeSizeExceeded,`Cannot encode a time larger than ${pe}: ${e}`);if(e<0)throw new F(k.EncodeTimeNegative,`Time must be positive: ${e}`);if(Number.isInteger(e)===!1)throw new F(k.EncodeTimeValueMalformed,`Time must be an integer: ${e}`);let r,s="";for(let p=a;p>0;p--)r=e%X,s=ye.charAt(r)+s,e=(e-r)/X;return s}function tt(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function at(e,a){const r=Ze(),s=Date.now();return et(s,Ee)+je(Ke,r)}var rt=z('<button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-white transition-colors"><div><!></div></button>'),nt=z('<button type="button"> </button>'),ot=z('<div class="absolute z-50 w-full mt-1 bg-neutral-800 border border-neutral-700 rounded-lg shadow-lg overflow-hidden"></div>'),lt=z('<div class="relative"><div class="relative"><input type="text"/> <!></div> <!></div>');function ae(e,a){ge(a,!0);let r=C(a,"value",15),s=C(a,"suggestions",19,()=>[]),p=C(a,"placeholder",3,""),f=C(a,"required",3,!1),y=C(a,"id",3,""),_=C(a,"class",3,""),d=x(!1),v=x(me([])),g=x(-1),i;Ce(()=>{r()&&r().length>0?n(v,s().filter(o=>o.toLowerCase().includes(r().toLowerCase())).slice(0,5),!0):n(v,s().slice(0,5),!0)});function N(){n(d,!0),n(g,-1)}function O(o){r(o),n(d,!1),n(g,-1)}function G(o){if(!(!t(d)||t(v).length===0))switch(o.key){case"ArrowDown":o.preventDefault(),n(g,Math.min(t(g)+1,t(v).length-1),!0);break;case"ArrowUp":o.preventDefault(),n(g,Math.max(t(g)-1,-1),!0);break;case"Enter":t(g)>=0&&(o.preventDefault(),O(t(v)[t(g)]));break;case"Escape":n(d,!1),n(g,-1);break}}function H(){setTimeout(()=>{n(d,!1),n(g,-1)},200)}function $(){n(d,!t(d)),t(d)&&i?.focus()}var D=lt(),I=u(D),m=u(I);ne(m),m.__input=N,m.__keydown=G,ze(m,o=>i=o,()=>i);var U=l(m,2);{var J=o=>{var h=rt();h.__click=$;var w=u(h);let T;var S=u(w);Xe(S,{size:16}),c(w),c(h),W(()=>T=L(w,1,"transition-transform",null,T,{"rotate-180":t(d)})),V(o,h)};be(U,o=>{s().length>0&&o(J)})}c(I);var P=l(I,2);{var K=o=>{var h=ot();Pe(h,21,()=>t(v),qe,(w,T,S)=>{var E=nt();E.__click=()=>O(t(T));let A;var q=u(E,!0);c(E),W(()=>{A=L(E,1,"w-full text-left px-3 py-2 hover:bg-neutral-700 transition-colors text-white text-sm",null,A,{"bg-neutral-700":S===t(g)}),xe(q,t(T))}),V(w,E)}),c(h),V(o,h)};be(P,o=>{t(d)&&t(v).length>0&&o(K)})}c(D),W(()=>{fe(m,"id",y()),fe(m,"placeholder",p()),m.required=f(),L(m,1,`bg-neutral-800 text-white px-3 py-2 pr-8 rounded border border-neutral-700 focus:border-blue-500 outline-none w-full ${_()??""}`)}),re("blur",m,H),re("focus",m,N),oe(m,r),V(e,D),_e()}he(["input","keydown","click"]);var st=z('<div class="p-4"><h1 class="text-2xl font-bold mb-6">Create Transaction</h1> <form class="space-y-4"><div class="flex flex-col gap-2"><label for="date" class="text-sm text-neutral-400">Date</label> <input id="date" type="date" required class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none"/></div> <div class="flex flex-col gap-2"><label for="description" class="text-sm text-neutral-400">Description</label> <!></div> <div class="flex flex-col gap-2"><label for="account" class="text-sm text-neutral-400">Account</label> <!></div> <div class="flex gap-2"><div class="flex-1 flex flex-col gap-2"><label for="amount" class="text-sm text-neutral-400">Amount</label> <input id="amount" type="number" step="0.01" required class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none"/></div> <div class="flex flex-col gap-2"><label for="currency" class="text-sm text-neutral-400">Currency</label> <select id="currency" class="bg-neutral-800 text-white px-3 py-2 rounded border border-neutral-700 focus:border-blue-500 outline-none"><option>EUR</option><option>USD</option><option>RUB</option><option>ARS</option></select></div></div> <div class="flex flex-col gap-2"><label for="category" class="text-sm text-neutral-400">Category</label> <!></div> <div class="flex flex-col gap-2"><label class="text-sm text-neutral-400">Transaction Type</label> <div class="flex gap-2"><button type="button">Debit (-)</button> <button type="button">Credit (+)</button></div></div> <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-neutral-700 disabled:cursor-not-allowed text-white font-medium py-3 rounded-lg transition-colors"> </button></form></div>');function mt(e,a){ge(a,!0);const r=()=>Le(O,"$transactions",s),[s,p]=Fe();let f=x(me(new Date().toISOString().split("T")[0])),y=x(""),_=x(0),d=x("EUR"),v=x(""),g=x(""),i=x("debit"),N=x(!1);const O=Be(()=>ve.transactions.toArray()),G=Ve(()=>{if(!r())return{descriptions:[],accounts:[],categories:[]};const b=new Set,R=new Set,de=new Set;return r().forEach(M=>{M.description&&b.add(M.description),M.account&&R.add(M.account),M.category&&de.add(M.category)}),{descriptions:Array.from(b).sort(),accounts:Array.from(R).sort(),categories:Array.from(de).sort()}});async function H(b){b.preventDefault(),n(N,!0);try{const R={id:at(),date:new Date(t(f)),description:t(y),amount:t(_),currency:t(d),account:t(v),category:t(g),kind:t(i)};await ve.transactions.add(R),Je.navigateTo("transactions")}catch(R){console.error("Failed to create transaction:",R),alert("Failed to create transaction")}finally{n(N,!1)}}var $=st(),D=l(u($),2),I=u(D),m=l(u(I),2);ne(m),c(I);var U=l(I,2),J=l(u(U),2);ae(J,{get suggestions(){return t(G).descriptions},placeholder:"Enter description",required:!0,id:"description",get value(){return t(y)},set value(b){n(y,b,!0)}}),c(U);var P=l(U,2),K=l(u(P),2);ae(K,{get suggestions(){return t(G).accounts},placeholder:"Enter account",required:!0,id:"account",get value(){return t(v)},set value(b){n(v,b,!0)}}),c(P);var o=l(P,2),h=u(o),w=l(u(h),2);ne(w),c(h);var T=l(h,2),S=l(u(T),2),E=u(S);E.value=E.__value="EUR";var A=l(E);A.value=A.__value="USD";var q=l(A);q.value=q.__value="RUB";var le=l(q);le.value=le.__value="ARS",c(S),c(T),c(o);var Q=l(o,2),we=l(u(Q),2);ae(we,{get suggestions(){return t(G).categories},placeholder:"Enter category",required:!0,id:"category",get value(){return t(g)},set value(b){n(g,b,!0)}}),c(Q);var Z=l(Q,2),se=l(u(Z),2),Y=u(se);Y.__click=()=>n(i,"debit");let ie;var ce=l(Y,2);ce.__click=()=>n(i,"credit");let ue;c(se),c(Z);var j=l(Z,2),Te=u(j,!0);c(j),c(D),c($),W(()=>{ie=L(Y,1,"flex-1 py-2 px-4 rounded-lg border transition-all",null,ie,{"bg-red-600":t(i)==="debit","border-red-600":t(i)==="debit","text-white":t(i)==="debit","bg-neutral-800":t(i)!=="debit","border-neutral-700":t(i)!=="debit","text-neutral-400":t(i)!=="debit"}),ue=L(ce,1,"flex-1 py-2 px-4 rounded-lg border transition-all",null,ue,{"bg-green-600":t(i)==="credit","border-green-600":t(i)==="credit","text-white":t(i)==="credit","bg-neutral-800":t(i)!=="credit","border-neutral-700":t(i)!=="credit","text-neutral-400":t(i)!=="credit"}),j.disabled=t(N),xe(Te,t(N)?"Creating...":"Create Transaction")}),re("submit",D,H),oe(m,()=>t(f),b=>n(f,b)),oe(w,()=>t(_),b=>n(_,b)),Ue(S,()=>t(d),b=>n(d,b)),V(e,$),_e(),p()}he(["click"]);export{mt as _,Je as n};
